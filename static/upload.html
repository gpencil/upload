<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å£°çº¿ä¸Šä¼ ç®¡ç†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-group input[readonly],
        .form-group textarea[readonly] {
            background-color: #f5f5f5;
            cursor: not-allowed;
            color: #666;
            border-color: #ddd;
        }

        .file-upload {
            border: 2px dashed #667eea;
            border-radius: 6px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f9f9f9;
        }

        .file-upload:hover {
            background: #f0f0ff;
            border-color: #764ba2;
        }

        .file-upload input {
            display: none;
        }

        .file-upload-label {
            color: #667eea;
            font-weight: 500;
        }

        .file-name {
            margin-top: 10px;
            color: #666;
            font-size: 14px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }

        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .search-box {
            display: flex;
            gap: 15px;
            align-items: flex-end;
            margin-bottom: 20px;
        }

        .search-box .form-group {
            margin-bottom: 0;
            flex: 1;
        }

        .voice-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .voice-item {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            background: #f9f9f9;
            transition: all 0.3s;
            cursor: pointer;
        }

        .voice-item:hover {
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .voice-item.selected {
            border-color: #667eea;
            background: #f0f0ff;
        }

        .voice-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .voice-icon {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            background: #ddd;
        }

        .voice-info h3 {
            margin: 0;
            font-size: 16px;
            color: #333;
        }

        .voice-info p {
            margin: 5px 0 0 0;
            font-size: 12px;
            color: #666;
        }

        .voice-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .badge.gender {
            background: #e3f2fd;
            color: #1976d2;
        }

        .badge.age {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .badge.language {
            background: #e8f5e9;
            color: #388e3c;
        }

        .badge.status-active {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .badge.status-inactive {
            background: #ffcdd2;
            color: #c62828;
        }

        .voice-description {
            margin-top: 10px;
            font-size: 13px;
            color: #555;
            line-height: 1.4;
        }

        .voice-actions {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 5px 12px;
            font-size: 12px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .audio-player {
            margin-top: 10px;
        }

        .audio-player audio {
            width: 100%;
            height: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ™ï¸ å£°çº¿ä¸Šä¼ ç®¡ç†ç³»ç»Ÿ</h1>
            <p>ä¸Šä¼ å£°çº¿å›¾æ ‡å’Œè¯•å¬éŸ³é¢‘ï¼Œç®¡ç†å£°çº¿é…ç½®</p>
        </div>

        <div class="card">
            <h2>ğŸ“¤ æ–‡ä»¶ä¸Šä¼ </h2>
            <div class="grid">
                <div>
                    <h3 style="margin-bottom: 15px; color: #667eea;">ä¸Šä¼ å£°çº¿å›¾æ ‡</h3>
                    <div class="file-upload" onclick="document.getElementById('iconFile').click()">
                        <input type="file" id="iconFile" accept="image/*" onchange="uploadFile('icon', this.files[0])">
                        <div class="file-upload-label">ğŸ“· ç‚¹å‡»é€‰æ‹©å›¾æ ‡æ–‡ä»¶</div>
                        <div class="file-name" id="iconFileName">æ”¯æŒ JPG, PNG ç­‰å›¾ç‰‡æ ¼å¼</div>
                    </div>
                    <div class="result" id="iconResult"></div>
                </div>

                <div>
                    <h3 style="margin-bottom: 15px; color: #667eea;">ä¸Šä¼ è¯•å¬éŸ³é¢‘</h3>
                    <div class="file-upload" onclick="document.getElementById('previewFile').click()">
                        <input type="file" id="previewFile" accept="audio/*" onchange="uploadFile('preview', this.files[0])">
                        <div class="file-upload-label">ğŸµ ç‚¹å‡»é€‰æ‹©éŸ³é¢‘æ–‡ä»¶</div>
                        <div class="file-name" id="previewFileName">æ”¯æŒ MP3, WAV ç­‰éŸ³é¢‘æ ¼å¼</div>
                    </div>
                    <div class="result" id="previewResult"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ“ å£°çº¿ä¿¡æ¯ç®¡ç†</h2>
            <form id="voiceForm">
                <div class="grid">
                    <div class="form-group">
                        <label for="voiceId">å£°çº¿ID (è‹±æ–‡) *</label>
                        <input type="text" id="voiceId" required placeholder="ä¾‹å¦‚: Jingcheng">
                    </div>

                    <div class="form-group">
                        <label for="name">å£°çº¿åç§° *</label>
                        <input type="text" id="name" required placeholder="ä¾‹å¦‚: æ™¯æ¾„">
                    </div>

                    <div class="form-group">
                        <label for="scenarioId">åœºæ™¯ *</label>
                        <select id="scenarioId" required>
                            <option value="">è¯·é€‰æ‹©åœºæ™¯</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="sortOrder">æ’åºæƒé‡</label>
                        <input type="number" id="sortOrder" value="0" placeholder="æ•°å­—è¶Šå¤§è¶Šé å‰">
                    </div>

                    <div class="form-group">
                        <label for="gender">æ€§åˆ«</label>
                        <select id="gender">
                            <option value="female">å¥³æ€§</option>
                            <option value="male">ç”·æ€§</option>
                            <option value="neutral">ä¸­æ€§</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="ageGroup">å¹´é¾„ç»„</label>
                        <select id="ageGroup">
                            <option value="adult">æˆå¹´</option>
                            <option value="young">é’å¹´</option>
                            <option value="child">å„¿ç«¥</option>
                            <option value="elderly">è€å¹´</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="style">å£°çº¿é£æ ¼</label>
                        <input type="text" id="style" placeholder="ä¾‹å¦‚: æ¸©æŸ”ã€æ´»æ³¼ã€ä¸“ä¸š">
                    </div>

                    <div class="form-group">
                        <label for="language">æ”¯æŒè¯­è¨€</label>
                        <select id="language">
                            <option value="zh-CN">ä¸­æ–‡</option>
                            <option value="en-US">è‹±è¯­</option>
                            <option value="zh-CN,en-US">ä¸­è‹±æ–‡</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="status">çŠ¶æ€</label>
                        <select id="status">
                            <option value="1">å¯ç”¨</option>
                            <option value="0">ç¦ç”¨</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="iconUrl">å£°çº¿å›¾æ ‡URL</label>
                    <input type="text" id="iconUrl" placeholder="ä»ä¸Šæ–¹ä¸Šä¼ å›¾æ ‡åè‡ªåŠ¨å¡«å……" readonly>
                </div>

                <div class="form-group">
                    <label for="previewUrl">è¯•å¬åœ°å€URL</label>
                    <input type="text" id="previewUrl" placeholder="ä»ä¸Šæ–¹ä¸Šä¼ éŸ³é¢‘åè‡ªåŠ¨å¡«å……" readonly>
                </div>

                <div class="form-group">
                    <label for="description">å£°çº¿æè¿°</label>
                    <textarea id="description" placeholder="è¯¦ç»†æè¿°å£°çº¿ç‰¹ç‚¹..."></textarea>
                </div>

                <div style="margin-top: 30px;">
                    <button type="submit" class="btn btn-primary">ğŸ’¾ ä¿å­˜å£°çº¿ä¿¡æ¯</button>
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">ğŸ”„ é‡ç½®</button>
                </div>

                <div class="result" id="voiceResult"></div>
            </form>
        </div>

        <div class="card">
            <h2>ğŸ” å£°çº¿åˆ—è¡¨æŸ¥è¯¢</h2>

            <div class="search-box">
                <div class="form-group">
                    <label for="searchVoiceId">å£°çº¿ID</label>
                    <input type="text" id="searchVoiceId" placeholder="è¾“å…¥å£°çº¿IDæŸ¥è¯¢">
                </div>

                <div class="form-group">
                    <label for="searchScenarioId">åœºæ™¯ID</label>
                    <input type="number" id="searchScenarioId" placeholder="è¾“å…¥åœºæ™¯IDæŸ¥è¯¢">
                </div>

                <div>
                    <button type="button" class="btn btn-primary" onclick="searchVoices()">ğŸ” æŸ¥è¯¢</button>
                    <button type="button" class="btn btn-secondary" onclick="clearSearch()">æ¸…ç©º</button>
                </div>
            </div>

            <div id="voiceListContainer">
                <div class="empty-state">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    <p>æš‚æ— æ•°æ®ï¼Œç‚¹å‡»"æŸ¥è¯¢"æŒ‰é’®åŠ è½½å£°çº¿åˆ—è¡¨</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // const API_BASE = 'http://localhost:8889';
        const API_BASE = 'http://192.168.50.49:8889/';

        async function uploadFile(type, file) {
            if (!file) return;

            const fileNameElement = document.getElementById(type + 'FileName');
            const resultElement = document.getElementById(type + 'Result');

            fileNameElement.textContent = 'ä¸Šä¼ ä¸­: ' + file.name;
            resultElement.style.display = 'none';

            const formData = new FormData();
            formData.append('file', file);
            formData.append('file_type', type);

            try {
                const response = await fetch(API_BASE + '/upload/oss', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                // å…¼å®¹ä¸¤ç§å“åº”æ ¼å¼ï¼šcode å’Œ errorCode
                const isSuccess = (result.code === 0 || result.errorCode === 0 || result.succeed === true) && result.data;

                if (isSuccess) {
                    fileNameElement.textContent = 'âœ… ' + file.name;
                    resultElement.className = 'result success';
                    resultElement.textContent = 'ä¸Šä¼ æˆåŠŸï¼URL: ' + result.data.name;
                    resultElement.style.display = 'block';

                    // è‡ªåŠ¨å¡«å……å¯¹åº”çš„URLå­—æ®µå¹¶è®¾ä¸ºåªè¯»
                    if (type === 'icon') {
                        const iconUrlInput = document.getElementById('iconUrl');
                        iconUrlInput.value = result.data.name;
                        iconUrlInput.readOnly = true;
                    } else {
                        const previewUrlInput = document.getElementById('previewUrl');
                        previewUrlInput.value = result.data.name;
                        previewUrlInput.readOnly = true;
                    }
                } else {
                    throw new Error(result.msg || result.errorMessage || 'ä¸Šä¼ å¤±è´¥');
                }
            } catch (error) {
                fileNameElement.textContent = 'âŒ ' + file.name;
                resultElement.className = 'result error';
                resultElement.textContent = 'ä¸Šä¼ å¤±è´¥: ' + error.message;
                resultElement.style.display = 'block';
            }
        }

        document.getElementById('voiceForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const resultElement = document.getElementById('voiceResult');
            resultElement.style.display = 'none';

            // è·å–å¹¶å»é™¤æ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µçš„é¦–å°¾ç©ºæ ¼
            const data = {
                voice_id: document.getElementById('voiceId').value.trim(),
                name: document.getElementById('name').value.trim(),
                scenario_id: parseInt(document.getElementById('scenarioId').value),
                sort_order: parseInt(document.getElementById('sortOrder').value),
                gender: document.getElementById('gender').value.trim(),
                age_group: document.getElementById('ageGroup').value.trim(),
                style: document.getElementById('style').value.trim(),
                language: document.getElementById('language').value.trim(),
                status: parseInt(document.getElementById('status').value),
                icon_url: document.getElementById('iconUrl').value.trim(),
                preview_url: document.getElementById('previewUrl').value.trim(),
                description: document.getElementById('description').value.trim()
            };

            try {
                const response = await fetch(API_BASE + '/upload/voice', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                // å…¼å®¹ä¸¤ç§å“åº”æ ¼å¼ï¼šcode å’Œ errorCode
                const isSuccess = result.code === 0 || result.errorCode === 0 || result.succeed === true;

                if (isSuccess) {
                    resultElement.className = 'result success';
                    resultElement.textContent = 'âœ… å£°çº¿ä¿¡æ¯ä¿å­˜æˆåŠŸï¼';
                    resultElement.style.display = 'block';

                    // 3ç§’åé‡ç½®è¡¨å•
                    setTimeout(() => {
                        resetForm();
                    }, 3000);
                } else {
                    throw new Error(result.msg || result.errorMessage || 'ä¿å­˜å¤±è´¥');
                }
            } catch (error) {
                resultElement.className = 'result error';
                resultElement.textContent = 'âŒ ä¿å­˜å¤±è´¥: ' + error.message;
                resultElement.style.display = 'block';
            }
        });

        function resetForm() {
            document.getElementById('voiceForm').reset();

            // é‡ç½® URL å­—æ®µå¹¶ç§»é™¤åªè¯»çŠ¶æ€ï¼Œå…è®¸é‡æ–°ä¸Šä¼ 
            const iconUrlInput = document.getElementById('iconUrl');
            const previewUrlInput = document.getElementById('previewUrl');
            iconUrlInput.value = '';
            previewUrlInput.value = '';
            iconUrlInput.readOnly = true;  // ä¿æŒåªè¯»ï¼Œåªèƒ½é€šè¿‡ä¸Šä¼ å¡«å……
            previewUrlInput.readOnly = true;  // ä¿æŒåªè¯»ï¼Œåªèƒ½é€šè¿‡ä¸Šä¼ å¡«å……

            document.getElementById('voiceResult').style.display = 'none';
            document.getElementById('iconResult').style.display = 'none';
            document.getElementById('previewResult').style.display = 'none';
            document.getElementById('iconFileName').textContent = 'æ”¯æŒ JPG, PNG ç­‰å›¾ç‰‡æ ¼å¼';
            document.getElementById('previewFileName').textContent = 'æ”¯æŒ MP3, WAV ç­‰éŸ³é¢‘æ ¼å¼';
        }

        // æŸ¥è¯¢å£°çº¿åˆ—è¡¨
        async function searchVoices() {
            const voiceId = document.getElementById('searchVoiceId').value.trim();
            const scenarioId = document.getElementById('searchScenarioId').value.trim();

            const params = new URLSearchParams();
            if (voiceId) params.append('voice_id', voiceId);
            if (scenarioId) params.append('scenario_id', scenarioId);

            try {
                const response = await fetch(API_BASE + '/config?' + params.toString());
                const result = await response.json();

                const isSuccess = result.code === 0 || result.errorCode === 0 || result.succeed === true;

                if (isSuccess && result.data && result.data.fullConfigs) {
                    renderVoiceList(result.data.fullConfigs);
                } else {
                    throw new Error(result.msg || result.errorMessage || 'æŸ¥è¯¢å¤±è´¥');
                }
            } catch (error) {
                showEmptyState('æŸ¥è¯¢å¤±è´¥: ' + error.message);
            }
        }

        // å­˜å‚¨å½“å‰æŸ¥è¯¢çš„æ‰€æœ‰å£°çº¿æ•°æ®
        let allVoicesData = [];

        // æ¸²æŸ“å£°çº¿åˆ—è¡¨
        function renderVoiceList(fullConfigs) {
            const container = document.getElementById('voiceListContainer');
            allVoicesData = [];

            fullConfigs.forEach(config => {
                if (config.voices && config.voices.length > 0) {
                    allVoicesData = allVoicesData.concat(config.voices);
                }
            });

            if (allVoicesData.length === 0) {
                showEmptyState('æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å£°çº¿');
                return;
            }

            const html = '<div class="voice-list">' + allVoicesData.map(voice => createVoiceCard(voice)).join('') + '</div>';
            container.innerHTML = html;
        }

        // åˆ›å»ºå£°çº¿å¡ç‰‡
        function createVoiceCard(voice) {
            const genderMap = { 'male': 'ç”·æ€§', 'female': 'å¥³æ€§', 'neutral': 'ä¸­æ€§' };
            const ageMap = { 'child': 'å„¿ç«¥', 'young': 'é’å¹´', 'adult': 'æˆå¹´', 'elderly': 'è€å¹´' };
            const statusClass = voice.status === 1 ? 'status-active' : 'status-inactive';
            const statusText = voice.status === 1 ? 'å¯ç”¨' : 'ç¦ç”¨';

            return `
                <div class="voice-item">
                    <div class="voice-header">
                        ${voice.iconUrl ? '<img src="' + voice.iconUrl + '" alt="' + voice.name + '" class="voice-icon" onerror="this.style.display=\'none\'">' : '<div class="voice-icon"></div>'}
                        <div class="voice-info">
                            <h3>${voice.name}</h3>
                            <p>ID: ${voice.voiceId} | åœºæ™¯: ${voice.scenarioId} | æ’åº: ${voice.sortOrder}</p>
                        </div>
                    </div>
                    <div class="voice-meta">
                        <span class="badge gender">${genderMap[voice.gender] || voice.gender}</span>
                        <span class="badge age">${ageMap[voice.ageGroup] || voice.ageGroup}</span>
                        <span class="badge language">${voice.language}</span>
                        ${voice.style ? '<span class="badge">' + voice.style + '</span>' : ''}
                        <span class="badge ${statusClass}">${statusText}</span>
                    </div>
                    ${voice.description ? '<div class="voice-description">' + voice.description + '</div>' : ''}
                    ${voice.previewUrl ? '<div class="audio-player"><audio controls preload="none"><source src="' + voice.previewUrl + '" type="audio/mpeg">æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾</audio></div>' : ''}
                    <div class="voice-actions">
                        <button class="btn btn-primary btn-small" onclick="loadVoiceToForm(${voice.id})">ğŸ“ ç¼–è¾‘</button>
                        ${voice.iconUrl ? '<button class="btn btn-secondary btn-small" onclick="window.open(\'' + voice.iconUrl + '\', \'_blank\')">ğŸ–¼ï¸ æŸ¥çœ‹å›¾æ ‡</button>' : ''}
                    </div>
                </div>
            `;
        }

        // æ˜¾ç¤ºç©ºçŠ¶æ€
        function showEmptyState(message) {
            document.getElementById('voiceListContainer').innerHTML = `
                <div class="empty-state">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    <p>${message}</p>
                </div>
            `;
        }

        // åŠ è½½å£°çº¿åˆ°è¡¨å•
        function loadVoiceToForm(voiceId) {
            const voice = allVoicesData.find(v => v.id === voiceId);
            if (!voice) return;

            document.getElementById('voiceId').value = voice.voiceId;
            document.getElementById('name').value = voice.name;
            document.getElementById('scenarioId').value = voice.scenarioId;
            document.getElementById('sortOrder').value = voice.sortOrder;
            document.getElementById('gender').value = voice.gender;
            document.getElementById('ageGroup').value = voice.ageGroup;
            document.getElementById('style').value = voice.style || '';
            document.getElementById('language').value = voice.language;
            document.getElementById('status').value = voice.status;
            document.getElementById('description').value = voice.description || '';

            // è®¾ç½® URL å­—æ®µå¹¶ä¿æŒåªè¯»çŠ¶æ€
            const iconUrlInput = document.getElementById('iconUrl');
            const previewUrlInput = document.getElementById('previewUrl');
            iconUrlInput.value = voice.iconUrl || '';
            previewUrlInput.value = voice.previewUrl || '';
            iconUrlInput.readOnly = true;
            previewUrlInput.readOnly = true;

            // æ»šåŠ¨åˆ°è¡¨å•ä½ç½®
            document.querySelector('.card:nth-child(3)').scrollIntoView({ behavior: 'smooth' });
        }

        // æ¸…ç©ºæœç´¢
        function clearSearch() {
            document.getElementById('searchVoiceId').value = '';
            document.getElementById('searchScenarioId').value = '';
            showEmptyState('æš‚æ— æ•°æ®ï¼Œç‚¹å‡»"æŸ¥è¯¢"æŒ‰é’®åŠ è½½å£°çº¿åˆ—è¡¨');
        }

        // åŠ è½½åœºæ™¯åˆ—è¡¨
        async function loadScenarios() {
            try {
                const response = await fetch(API_BASE + '/scenario_id');
                const result = await response.json();

                const isSuccess = result.code === 0 || result.errorCode === 0 || result.succeed === true;

                if (isSuccess && result.data && result.data.scenarioIds) {
                    const scenarioSelect = document.getElementById('scenarioId');

                    // æ¸…ç©ºç°æœ‰é€‰é¡¹ï¼ˆä¿ç•™ç¬¬ä¸€ä¸ª"è¯·é€‰æ‹©"ï¼‰
                    scenarioSelect.innerHTML = '<option value="">è¯·é€‰æ‹©åœºæ™¯</option>';

                    // æ·»åŠ åœºæ™¯é€‰é¡¹
                    result.data.scenarioIds.forEach(scenario => {
                        const option = document.createElement('option');
                        option.value = scenario.id;
                        option.textContent = scenario.name;
                        scenarioSelect.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('åŠ è½½åœºæ™¯åˆ—è¡¨å¤±è´¥:', error);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æŸ¥è¯¢æ‰€æœ‰å£°çº¿å’Œåœºæ™¯åˆ—è¡¨
        window.addEventListener('load', () => {
            loadScenarios();
            searchVoices();
        });
    </script>
</body>
</html>
